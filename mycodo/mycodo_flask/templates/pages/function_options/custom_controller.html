{%- for each_controller in custom_controllers if each_controller.unique_id == order -%}

<div class="container" style="border: 2px solid #ddd; border-radius: 5px;">

  <form method="post" action="/function">
  <input type="hidden" name="form-name" value="modController">
  {{form_custom_controller.csrf_token}}
  {{form_custom_controller.function_id(value=each_controller.unique_id)}}
  {{form_custom_controller.function_type(class_='form-control', value='custom_controller')}}

  <div class="{% if each_controller.is_activated -%}active-background
              {% else -%}inactive-background
              {% endif -%} row small-gutters" style="border-bottom: 1px solid #ddd; padding: 0.3em 0.2em 0.3em 0.3em;">

    <div class="col-2 col-sm-1 text-center icon-fh">
      <a data-toggle="collapse" href="#collapseContainer-controller-{{each_controller.id}}" aria-expanded="false" aria-controls="collapseContainer-controller-{{each_controller.id}}">
        <span style="font-size: 3.6em" class="collapse-button{{each_controller.id}} fa fa-plus-square"></span>
      </a>
    </div>
    <div class="col-5 col-sm-4 col-md-3 col-lg-4">
      {{form_custom_controller.name(class_='form-control', value=each_controller.name, **{'title': dict_translation['name']['phrase']})}}
    </div>
    <div class="col-5 col-sm-3 col-md-4 col-lg-3">
      <input class="form-control btn btn-sm" disabled="" title="UUID: {{each_controller.unique_id}}" value="[{{dict_translation['controller']['title']}}]
        {%- if each_controller.is_activated %} {{_('Active')}}
        {%- else %} {{_('Inactive')}}
        {%- endif -%}
      " type="text">
    </div>

    <div class="col-6 col-sm-4 col-md-4 col-lg-4">
      {%- if each_controller.is_activated %}
        {{form_custom_controller.deactivate_controller(class_='form-control btn btn-sm')}}
      {%- else %}
        {{form_custom_controller.activate_controller(class_='form-control btn btn-sm')}}
      {%- endif -%}
    </div>
  </div>

  <div class="collapse" id="collapseContainer-controller-{{each_controller.id}}">

    <div class="row small-gutters" style="padding: 0.5em;">
      <div class="col-auto small-gutters">
        {{form_custom_controller.save_controller(class_='form-control btn btn-sm')}}
      </div>
      <div class="col-auto small-gutters">
        {{form_custom_controller.delete_controller(class_='form-control btn btn-sm',**{'onclick':'return confirm("Are you sure you want to delete this?")'})}}
      </div>
      <div class="col-auto small-gutters">
        {{form_custom_controller.order_up(class_='form-control btn btn-sm')}}
      </div>
      <div class="col-auto small-gutters">
        {{form_custom_controller.order_down(class_='form-control btn btn-sm')}}
      </div>
    </div>

    <div class="row small-gutters" style="padding-bottom: 0.3em">
      <div class="col-auto">
        {{form_custom_controller.log_level_debug.label(class_='control-label')}}
        <div class="input-group-text">
          <input id="log_level_debug" name="log_level_debug" type="checkbox" title="{{dict_translation['log_level_debug']['phrase']}}" value="y"{% if each_controller.log_level_debug %} checked{% endif %}>
        </div>
      </div>

    {% if 'custom_options' in dict_controllers[each_controller.device]['options_enabled'] %}

      {% for each_option in dict_controllers[each_controller.device]['custom_options'] %}

        {% if each_option['type'] in ['float', 'integer', 'text'] %}

      <div class="col-auto">
        <label class="control-label" for="{{each_option['id']}}">{{each_option['name']}}</label>
        <div>
          <input class="form-control" id="{{each_option['id']}}" name="{{each_option['id']}}" title="{{each_option['phrase']}}" type="text" value="{{custom_options_values_controllers[each_controller.unique_id][each_option['id']]}}">
        </div>
      </div>

          {% elif each_option['type'] == 'select' %}

      <div class="col-auto">
        <label class="control-label" for="{{each_option['id']}}">{{each_option['name']}}</label>
        <div>
          <select class="form-control form-tooltip form-dropdown" data-placement="top" id="{{each_option['id']}}" name="{{each_option['id']}}" title="{{each_option['phrase']}}">
            <option value="">{{dict_translation['select_one']['title']}}</option>
            {% for each_set in each_option['options_select'] %}
            <option value="{{each_set[0]}}"{% if each_set[0] == custom_options_values_controllers[each_controller.unique_id][each_option['id']] %} selected{% endif %}>{{each_set[1]}}</option>
            {% endfor %}
          </select>
        </div>
      </div>

          {% elif each_option['type'] == 'bool' %}

      <div class="col-auto">
        <label class="control-label" for="{{each_option['id']}}">{{each_option['name']}}</label>
        <div class="input-group-text">
          <input id="{{each_option['id']}}" name="{{each_option['id']}}" title="{{each_option['phrase']}}" type="checkbox" value="y"{% if custom_options_values_controllers[each_controller.unique_id][each_option['id']] %} checked{% endif %}>
        </div>
      </div>

        {% endif %}

      {% endfor %}

    {% endif %}

    </div>

  </div>
  </form>

</div>

<div style="padding-bottom: 0.5em; "></div>

{%- endfor -%}
